type User {
  id: ID!
  email: String!
  name: String!
  password: String
  role: UserRole!
  firm: Firm!
}

enum UserRole {
  ADMIN
  STAFF
}

type AuthResponse {
  token: String!
  firm: Firm!
  user: User!
}

extend type Mutation {
  createUser(
    name: String! @length(min: 2, max: 100)
    email: String! @length(min: 5, max: 255)
    password: String! @length(min: 6, max: 100)
    role: UserRole!
    firmId: ID!
  ): User! @auth @hasRole(roles: ["ADMIN"])

  deleteUser(id: ID!): User! @auth @hasRole(roles: ["ADMIN"])

  login(
    email: String! @length(min: 5, max: 255)
    password: String! @length(min: 6, max: 100)
  ): AuthResponse! @rateLimit(limit: 5, duration: 60)
}

extend type Query {
  me: User @auth
  users: [User!]! @auth @hasRole(roles: ["ADMIN"])
}
