# Bill schema

type Bill {
  id: ID!
  title: String!
  createdAt: String!
  user: User!
  items: [BillItem!]!
  totalAmount: Float!
  firm: Firm!
  customerName: String
  customerPhone: String
}

type BillItem {
  id: ID!
  product: Product
  productName: String!
  quantity: Int!
  price: Float!
  total: Float!
}

type MonthlyStats {
  month: Int!
  year: Int!
  billsCount: Int!
  totalAmount: Float!
}

input BillItemInput {
  productId: ID
  productName: String! @length(min: 1, max: 200)
  price: Float
  quantity: Int!
}

input CreateBillInput {
  title: String! @length(min: 1, max: 200)
  customerName: String
  customerPhone: String
  items: [BillItemInput!]!
}

extend type Query {
  bills: [Bill!]! @auth @hasRole(roles: ["ADMIN"])
  bill(id: ID!): Bill @auth @hasRole(roles: ["ADMIN"])
  myBills: [Bill!]! @auth
  monthlyStats(month: Int!, year: Int!): MonthlyStats!
    @auth
    @hasRole(roles: ["ADMIN"])
  myMonthlyStats(month: Int!, year: Int!): MonthlyStats! @auth
}

extend type Mutation {
  createBill(input: CreateBillInput!): Bill! @auth
  updateBill(id: ID!, input: CreateBillInput!): Bill! @auth
  deleteBill(id: ID!): Boolean! @auth @hasRole(roles: ["ADMIN"])
}
